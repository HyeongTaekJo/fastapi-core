2025-04-07 19:32:14,979 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost'")
(Background on this error at: https://sqlalche.me/e/20/e3q8) | POST /auth/login/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 527, in _connect
    self._reader, self._writer = await \
  File "C:\Users\jht56\anaconda3\envs\backend\lib\asyncio\tasks.py", line 408, in wait_for
    return await fut
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 88, in _open_connection
    transport, _ = await loop.create_connection(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\asyncio\base_events.py", line 1084, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 10061] Connect call failed ('::1', 3308, 0, 0), [Errno 10061] Connect call failed ('127.0.0.1', 3308)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 563, in _connect
    raise OperationalError(
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    solved_result = await solve_dependencies(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    solved = await call(**sub_values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    user = await auth_service.authenticate_with_email_password(
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    user = await self.userRepository.get_user_by_email(email)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    return await self.session.scalar(select(UserModel).where(UserModel.email == email))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    return await greenlet_spawn(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    return self._execute_internal(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    return self._connection_cls(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 563, in _connect
    raise OperationalError(
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-07 19:32:49,082 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query')
(Background on this error at: https://sqlalche.me/e/20/e3q8) | POST /auth/login/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\asyncio\streams.py", line 706, in readexactly
    raise exceptions.IncompleteReadError(incomplete, n)
asyncio.exceptions.IncompleteReadError: 0 bytes read on a total of 4 expected bytes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 539, in _connect
    await self._get_server_information()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1048, in _get_server_information
    packet = await self._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 661, in _read_bytes
    raise OperationalError(CR.CR_SERVER_LOST, msg) from e
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    solved_result = await solve_dependencies(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    solved = await call(**sub_values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    user = await auth_service.authenticate_with_email_password(
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    user = await self.userRepository.get_user_by_email(email)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    return await self.session.scalar(select(UserModel).where(UserModel.email == email))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    return await greenlet_spawn(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    return self._execute_internal(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    return self._connection_cls(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 539, in _connect
    await self._get_server_information()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1048, in _get_server_information
    packet = await self._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 661, in _read_bytes
    raise OperationalError(CR.CR_SERVER_LOST, msg) from e
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-07 19:43:07,337 [DEBUG] [req_id:96691be5-bbb3-48ed-8e38-8f4f9a03582b user:None] connection.py:960 - caching sha2: Trying full auth...
2025-04-07 19:43:07,340 [DEBUG] [req_id:96691be5-bbb3-48ed-8e38-8f4f9a03582b user:None] connection.py:982 - -----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyV25Sr7UWBMq6Ra4VJJI
pcD6PZam9wPQWt0dWBDSQhXkzy1Nhts8K8U8EnvSL60AK+eZwB1SqkmLMdmql6Zm
KpekZ7EAL52ITDu3Dvjjzw+Rp/2bZVR9cMYvTAWPhIlf02bFUbeNMLo9KeXcFLUx
1mDxZTZo69v0LiJxAhOLMhwKAclgVRJcvB9DnNcBb5yxljYrTaPibm+HEfvKhpd8
whPd5fdEcHVJ0KS8GZGTG0CneeR97UmJPYl1MZWlwZD7vDphre3vjf/rUITR0JDq
p9mp8/ZR3ZnrQGpKCJW/HKkEOuCZfyLkKej8wR8kChEpCuxz27DmdZHjhANW+R5A
CwIDAQAB
-----END PUBLIC KEY-----

2025-04-07 19:43:07,342 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods | POST /auth/login/email
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    |     return await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    |     solved_result = await solve_dependencies(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    |     solved = await call(**sub_values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    |     user = await auth_service.authenticate_with_email_password(
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    |     user = await self.userRepository.get_user_by_email(email)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    |     return await self.session.scalar(select(UserModel).where(UserModel.email == email))
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    |     return await greenlet_spawn(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    |     result = context.throw(*sys.exc_info())
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    |     return self._execute_internal(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    |     return self._connection_cls(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    |     return self.pool.connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    |     with util.safe_reraise():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    |     return self._create_connection()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    |     return _ConnectionRecord(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    |     self.__connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    |     with util.safe_reraise():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    |     self.dbapi_connection = connection = pool._invoke_creator(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    |     return dialect.connect(*cargs, **cparams)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    |     return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    |     await_only(creator_fn(*arg, **kw)),
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    |     value = await result
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    |     await conn._connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 540, in _connect
    |     await self._request_authentication()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 865, in _request_authentication
    |     await self.caching_sha2_password_auth(auth_packet)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 984, in caching_sha2_password_auth
    |     data = _auth.sha2_rsa_encrypt(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    |     raise RuntimeError(
    | RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    solved_result = await solve_dependencies(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    solved = await call(**sub_values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    user = await auth_service.authenticate_with_email_password(
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    user = await self.userRepository.get_user_by_email(email)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    return await self.session.scalar(select(UserModel).where(UserModel.email == email))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    return await greenlet_spawn(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    return self._execute_internal(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    return self._connection_cls(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 865, in _request_authentication
    await self.caching_sha2_password_auth(auth_packet)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 984, in caching_sha2_password_auth
    data = _auth.sha2_rsa_encrypt(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-04-07 19:46:01,910 [DEBUG] [req_id:0605b9b6-8c89-4f1d-8fcd-f45078bbffb1 user:None] connection.py:960 - caching sha2: Trying full auth...
2025-04-07 19:46:01,912 [DEBUG] [req_id:0605b9b6-8c89-4f1d-8fcd-f45078bbffb1 user:None] connection.py:982 - -----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyV25Sr7UWBMq6Ra4VJJI
pcD6PZam9wPQWt0dWBDSQhXkzy1Nhts8K8U8EnvSL60AK+eZwB1SqkmLMdmql6Zm
KpekZ7EAL52ITDu3Dvjjzw+Rp/2bZVR9cMYvTAWPhIlf02bFUbeNMLo9KeXcFLUx
1mDxZTZo69v0LiJxAhOLMhwKAclgVRJcvB9DnNcBb5yxljYrTaPibm+HEfvKhpd8
whPd5fdEcHVJ0KS8GZGTG0CneeR97UmJPYl1MZWlwZD7vDphre3vjf/rUITR0JDq
p9mp8/ZR3ZnrQGpKCJW/HKkEOuCZfyLkKej8wR8kChEpCuxz27DmdZHjhANW+R5A
CwIDAQAB
-----END PUBLIC KEY-----

2025-04-07 19:46:01,915 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods | POST /auth/login/email
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    |     return await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    |     solved_result = await solve_dependencies(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    |     solved = await call(**sub_values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    |     user = await auth_service.authenticate_with_email_password(
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    |     user = await self.userRepository.get_user_by_email(email)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    |     return await self.session.scalar(select(UserModel).where(UserModel.email == email))
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    |     return await greenlet_spawn(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    |     result = context.throw(*sys.exc_info())
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    |     return self._execute_internal(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    |     return self._connection_cls(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    |     return self.pool.connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    |     with util.safe_reraise():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    |     return self._create_connection()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    |     return _ConnectionRecord(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    |     self.__connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    |     with util.safe_reraise():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    |     self.dbapi_connection = connection = pool._invoke_creator(self)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    |     return dialect.connect(*cargs, **cparams)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    |     return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    |     await_only(creator_fn(*arg, **kw)),
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    |     value = await result
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    |     await conn._connect()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 540, in _connect
    |     await self._request_authentication()
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 865, in _request_authentication
    |     await self.caching_sha2_password_auth(auth_packet)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 984, in caching_sha2_password_auth
    |     data = _auth.sha2_rsa_encrypt(
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    |     raise RuntimeError(
    | RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    solved_result = await solve_dependencies(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    solved = await call(**sub_values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    user = await auth_service.authenticate_with_email_password(
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    user = await self.userRepository.get_user_by_email(email)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    return await self.session.scalar(select(UserModel).where(UserModel.email == email))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    return await greenlet_spawn(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    return self._execute_internal(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    return self._connection_cls(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 865, in _request_authentication
    await self.caching_sha2_password_auth(auth_packet)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 984, in caching_sha2_password_auth
    data = _auth.sha2_rsa_encrypt(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\_auth.py", line 144, in sha2_rsa_encrypt
    raise RuntimeError(
RuntimeError: 'cryptography' package is required for sha256_password or caching_sha2_password auth methods
2025-04-07 19:47:02,913 [DEBUG] [req_id:13561f25-d22d-4d95-946b-56debb69815d user:None] connection.py:960 - caching sha2: Trying full auth...
2025-04-07 19:47:02,915 [DEBUG] [req_id:13561f25-d22d-4d95-946b-56debb69815d user:None] connection.py:982 - -----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyV25Sr7UWBMq6Ra4VJJI
pcD6PZam9wPQWt0dWBDSQhXkzy1Nhts8K8U8EnvSL60AK+eZwB1SqkmLMdmql6Zm
KpekZ7EAL52ITDu3Dvjjzw+Rp/2bZVR9cMYvTAWPhIlf02bFUbeNMLo9KeXcFLUx
1mDxZTZo69v0LiJxAhOLMhwKAclgVRJcvB9DnNcBb5yxljYrTaPibm+HEfvKhpd8
whPd5fdEcHVJ0KS8GZGTG0CneeR97UmJPYl1MZWlwZD7vDphre3vjf/rUITR0JDq
p9mp8/ZR3ZnrQGpKCJW/HKkEOuCZfyLkKej8wR8kChEpCuxz27DmdZHjhANW+R5A
CwIDAQAB
-----END PUBLIC KEY-----

2025-04-07 19:47:02,971 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.ProgrammingError) (1146, "Table 'mysql-server.user' doesn't exist")
[SQL: SELECT user.nickname, user.email, user.password, user.`role`, user.id, user.created_at, user.updated_at 
FROM user 
WHERE user.email = %s]
[parameters: ('jht@naver.com',)]
(Background on this error at: https://sqlalche.me/e/20/f405) | POST /auth/login/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'mysql-server.user' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 269, in app
    solved_result = await solve_dependencies(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\dependencies\utils.py", line 600, in solve_dependencies
    solved = await call(**sub_values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\tokens\basic_token.py", line 21, in basic_token
    user = await auth_service.authenticate_with_email_password(
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 90, in authenticate_with_email_password
    user = await self.userRepository.get_user_by_email(email)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 15, in get_user_by_email
    return await self.session.scalar(select(UserModel).where(UserModel.email == email))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 519, in scalar
    return await greenlet_spawn(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2413, in scalar
    return self._execute_internal(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'mysql-server.user' doesn't exist")
[SQL: SELECT user.nickname, user.email, user.password, user.`role`, user.id, user.created_at, user.updated_at 
FROM user 
WHERE user.email = %s]
[parameters: ('jht@naver.com',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-07 19:50:43,071 [WARNING] [req_id:78da46d8-1dc8-4890-a6e4-12ed989ec2dc user:None] handlers.py:64 - Unhandled HTTPException: 401 - 존재하지 않는 User 입니다. | POST /auth/login/email
2025-04-07 19:50:43,072 [INFO] [req_id:78da46d8-1dc8-4890-a6e4-12ed989ec2dc user:None] base.py:35 - POST /auth/login/email [401] 0.006s
2025-04-07 19:50:59,231 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 19:52:34,505 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test', 'jht@naver.com', '$2b$10$Ql2NcwpP9jYM6Hj0iU8ZvuA.MzkZWiwkbe6h6folJixUGTw1e8L/G', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj) | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'jht@naver.com' for key 'user.email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 47, in register_user
    return await auth_service.register_user(request)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 138, in register_user
    new_user = await self.userRepository.create_user(new_user_model)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 24, in create_user
    await self.session.commit()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test', 'jht@naver.com', '$2b$10$Ql2NcwpP9jYM6Hj0iU8ZvuA.MzkZWiwkbe6h6folJixUGTw1e8L/G', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-07 19:52:37,617 [INFO] [req_id:f5581b7a-576d-4e61-af3a-adbce00c944a user:None] base.py:35 - POST /auth/login/email [200] 0.0795s
2025-04-07 19:53:01,793 [INFO] [req_id:75ed978d-50ce-406f-afaa-5e8b35c6872a user:None] base.py:35 - POST /auth/login/email [200] 0.0693s
2025-04-07 19:53:10,612 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 19:53:24,941 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 401: 잘못된 토큰입니다. | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    |     user = decode_jwt_token(token) if token else None
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    |     raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
    | fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    user = decode_jwt_token(token) if token else None
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
2025-04-07 19:53:27,688 [INFO] [req_id:f83213e2-6484-428b-8bc3-881ec8f5558b user:None] base.py:35 - POST /auth/login/email [200] 0.0734s
2025-04-07 19:53:29,935 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 401: 잘못된 토큰입니다. | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    |     user = decode_jwt_token(token) if token else None
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    |     raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
    | fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    user = decode_jwt_token(token) if token else None
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
2025-04-07 19:53:40,392 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 401: 잘못된 토큰입니다. | GET /posts
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    |     user = decode_jwt_token(token) if token else None
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    |     raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
    | fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    user = decode_jwt_token(token) if token else None
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 153, in decode_jwt_token
    raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
2025-04-07 19:53:51,998 [DEBUG] [req_id:2422a3e8-9ba7-460f-9b44-48aad4abfa50 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 19:53:52,093 [INFO] [req_id:2422a3e8-9ba7-460f-9b44-48aad4abfa50 user:None] base.py:35 - POST /auth/login/email [200] 0.1243s
2025-04-07 19:53:57,149 [INFO] [req_id:31246ad6-de76-43fd-a0c6-6ddecce45f34 user:1] base.py:35 - GET /posts [200] 0.0082s
2025-04-07 19:54:03,404 [WARNING] [req_id:0f575bde-ba01-43d9-968a-19170887efab user:1] handlers.py:64 - Unhandled HTTPException: 404 - post not found | GET /posts/100
2025-04-07 19:54:03,404 [INFO] [req_id:0f575bde-ba01-43d9-968a-19170887efab user:1] base.py:35 - GET /posts/100 [404] 0.0147s
2025-04-07 19:54:27,675 [INFO] [req_id:910ca16d-7931-4c66-8043-e012b73e43b2 user:1] base.py:35 - POST /posts/random [200] 0.0296s
2025-04-07 19:54:33,427 [INFO] [req_id:40f25a45-9289-4ad6-997c-8b28dcc64a03 user:1] base.py:35 - GET /posts [200] 0.0307s
2025-04-07 19:54:39,225 [INFO] [req_id:b3fa1837-ef6b-4305-b722-ba3875735db6 user:None] base.py:35 - GET /posts [200] 0.0141s
2025-04-07 19:54:42,532 [INFO] [req_id:06d9389f-0193-423c-b291-269d483c5262 user:1] base.py:35 - GET /posts/100 [200] 0.014s
2025-04-07 19:54:50,562 [WARNING] [req_id:bacebbf1-990d-49e8-ac16-8e6894436a5b user:None] handlers.py:35 - Validation failed: [{'type': 'int_parsing', 'loc': ('path', 'id'), 'msg': 'Input should be a valid integer, unable to parse string as an integer', 'input': ':id'}]
2025-04-07 19:54:50,563 [INFO] [req_id:bacebbf1-990d-49e8-ac16-8e6894436a5b user:None] base.py:35 - GET /users/id/:id [422] 0.0119s
2025-04-07 19:55:00,300 [INFO] [req_id:36c64bc2-37ac-4380-b74d-1ed4492e2735 user:None] base.py:35 - GET /users/id/1 [200] 0.017s
2025-04-07 19:55:05,969 [INFO] [req_id:bcdf31ca-fbb3-4c4d-b4c4-52f05c0c712a user:None] base.py:35 - GET /users/email/jht@naver.com [200] 0.0142s
2025-04-07 19:56:06,415 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_part_begin with no data
2025-04-07 19:56:06,415 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_header_field with data[54:73]
2025-04-07 19:56:06,417 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_header_value with data[75:151]
2025-04-07 19:56:06,417 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 19:56:06,417 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_header_field with data[153:165]
2025-04-07 19:56:06,418 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_header_value with data[167:177]
2025-04-07 19:56:06,418 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 19:56:06,418 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_headers_finished with no data
2025-04-07 19:56:06,418 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_part_data with data[181:131253]
2025-04-07 19:56:06,426 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_part_data with data[0:65536]
2025-04-07 19:56:06,429 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_part_data with data[0:196608]
2025-04-07 19:56:06,431 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:625 - Calling on_part_data with data[0:12905]
2025-04-07 19:56:06,431 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_part_end with no data
2025-04-07 19:56:06,432 [DEBUG] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] multipart.py:628 - Calling on_end with no data
2025-04-07 19:56:06,436 [INFO] [req_id:adbf0e61-8934-4e05-ae7f-956f83214d8a user:1] base.py:35 - POST /common/image [200] 0.0223s
2025-04-07 19:56:15,550 [INFO] [req_id:931b39fd-7634-4d29-a0cd-f1881c75e301 user:1] base.py:35 - POST /posts [200] 0.0559s
2025-04-07 19:56:21,600 [INFO] [req_id:0ca9d842-cc8f-4720-8bc7-f60fa46e197e user:None] base.py:35 - POST /auth/login/email [200] 0.0743s
2025-04-07 19:56:25,682 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht2@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test2', 'jht2@naver.com', '$2b$10$oS88UVyRDxSQWVLUArf.Cuau4omo/OxWwUxttd6Jc8TPYFBIO/q1m', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj) | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'jht2@naver.com' for key 'user.email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 47, in register_user
    return await auth_service.register_user(request)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 138, in register_user
    new_user = await self.userRepository.create_user(new_user_model)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 24, in create_user
    await self.session.commit()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht2@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test2', 'jht2@naver.com', '$2b$10$oS88UVyRDxSQWVLUArf.Cuau4omo/OxWwUxttd6Jc8TPYFBIO/q1m', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-07 19:57:31,525 [INFO] [req_id:2f654c82-a32a-4960-a520-6b384f4cc649 user:None] base.py:35 - POST /auth/login/email [200] 0.081s
2025-04-07 19:57:37,411 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 19:59:55,942 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 19:59:59,796 [DEBUG] [req_id:7f58629d-22dd-4028-8946-3c93c9373934 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 19:59:59,816 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht4@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test4', 'jht4@naver.com', '$2b$10$GwiPfLvn2M1ZP17PLQRbcu1f1WYSSjhwbWlSmsz1MreEYEA1koYBu', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj) | POST /auth/register/email
Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'jht4@naver.com' for key 'user.email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 47, in register_user
    return await auth_service.register_user(request)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 138, in register_user
    new_user = await self.userRepository.create_user(new_user_model)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 24, in create_user
    await self.session.commit()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht4@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test4', 'jht4@naver.com', '$2b$10$GwiPfLvn2M1ZP17PLQRbcu1f1WYSSjhwbWlSmsz1MreEYEA1koYBu', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-07 20:00:29,921 [DEBUG] [req_id:3e64dbe3-42ca-4cc4-8198-c8f26f0d4a37 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:00:29,967 [INFO] [req_id:3e64dbe3-42ca-4cc4-8198-c8f26f0d4a37 user:None] base.py:35 - POST /auth/register/email [200] 0.1471s
2025-04-07 20:09:25,688 [INFO] [req_id:d8ed2215-cd65-4505-af44-7240138fa28f user:None] base.py:35 - POST /auth/login/email [200] 0.082s
2025-04-07 20:09:31,367 [DEBUG] [req_id:1ecf0e32-9c2e-47be-b07e-dc8d76e115d1 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:09:31,492 [INFO] [req_id:1ecf0e32-9c2e-47be-b07e-dc8d76e115d1 user:None] base.py:35 - POST /auth/login/email [200] 0.1473s
2025-04-07 20:16:31,454 [DEBUG] [req_id:049c5886-a621-4323-9184-fb4ae3047067 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:16:31,571 [INFO] [req_id:049c5886-a621-4323-9184-fb4ae3047067 user:None] base.py:35 - POST /auth/login/email [200] 0.1394s
2025-04-07 20:16:45,608 [INFO] [req_id:1c52cd53-2259-4f07-aabf-d9eb29cf7cff user:None] base.py:35 - POST /auth/register/email [200] 0.0791s
2025-04-07 20:18:29,207 [INFO] [req_id:83ada3b7-470e-498e-9edd-daf863c48c2d user:None] base.py:35 - POST /auth/register/email [200] 0.0902s
2025-04-07 20:20:58,983 [DEBUG] [req_id:4434e1aa-42c8-428c-8fac-8b2c82a23aa7 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:21:57,496 [INFO] [req_id:4434e1aa-42c8-428c-8fac-8b2c82a23aa7 user:None] base.py:35 - POST /auth/register/email [200] 58.63s
2025-04-07 20:22:17,389 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht8@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test8', 'jht8@naver.com', '$2b$10$CmBYgRZBykAX0vKMqPn9S.j37pUfHWZB8IgAa8Pafb4MQPLrwd39O', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj) | POST /auth/register/email
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'jht8@naver.com' for key 'user.email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 47, in register_user
    tokens = await auth_service.register_user(request)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 135, in register_user
    new_user = await self.userRepository.create_user(new_user_model)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\user\repository.py", line 24, in create_user
    await self.session.commit()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1015, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 97, in execute
    return self.await_(self._execute_async(operation, parameters))
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 106, in _execute_async
    result = await self._cursor.execute(operation, parameters)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'jht8@naver.com' for key 'user.email'")
[SQL: INSERT INTO user (nickname, email, password, `role`) VALUES (%s, %s, %s, %s)]
[parameters: ('test8', 'jht8@naver.com', '$2b$10$CmBYgRZBykAX0vKMqPn9S.j37pUfHWZB8IgAa8Pafb4MQPLrwd39O', 'USER')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-07 20:25:15,072 [DEBUG] [req_id:ceaa187c-dc5d-42f3-83b1-39e9e01d4958 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:25:15,125 [WARNING] [req_id:ceaa187c-dc5d-42f3-83b1-39e9e01d4958 user:None] handlers.py:64 - Unhandled HTTPException: 400 - 이미 등록된 이메일입니다. | POST /auth/register/email
2025-04-07 20:25:15,126 [INFO] [req_id:ceaa187c-dc5d-42f3-83b1-39e9e01d4958 user:None] base.py:35 - POST /auth/register/email [400] 0.0941s
2025-04-07 20:26:58,987 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: 401: 잘못된 토큰입니다. | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    |     user = decode_jwt_token(token) if token else None
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 158, in decode_jwt_token
    |     raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
    | fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 55, in auth_middleware
    user = decode_jwt_token(token) if token else None
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 158, in decode_jwt_token
    raise HTTPException(status_code=401, detail="잘못된 토큰입니다.")
fastapi.exceptions.HTTPException: 401: 잘못된 토큰입니다.
2025-04-07 20:27:11,513 [INFO] [req_id:1943a5ff-3813-4c51-a6b1-93b43a77ffb6 user:None] base.py:35 - POST /auth/login/email [200] 0.1197s
2025-04-07 20:27:44,669 [INFO] [req_id:ff4355b1-2bbe-4536-9710-22983e777670 user:1] base.py:35 - POST /auth/token/access [200] 0.004s
2025-04-07 20:27:50,439 [INFO] [req_id:dc75ee01-74b3-4c01-865e-2501ca4b6877 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0048s
2025-04-07 20:33:01,987 [DEBUG] [req_id:e66e3e8f-d26f-45fc-9242-b711ba88c6fb user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:33:02,169 [INFO] [req_id:e66e3e8f-d26f-45fc-9242-b711ba88c6fb user:None] base.py:35 - POST /auth/login/email [200] 0.2189s
2025-04-07 20:33:11,434 [INFO] [req_id:61fe3d1b-84d0-4caa-ad14-f12c379de4d2 user:None] base.py:35 - POST /auth/login/email [200] 0.0877s
2025-04-07 20:40:13,654 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:40:44,183 [DEBUG] [req_id:5a7c63ef-4446-4d45-a63e-61ca7e2e6354 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:40:44,328 [INFO] [req_id:5a7c63ef-4446-4d45-a63e-61ca7e2e6354 user:None] base.py:35 - POST /auth/login/email [200] 0.1717s
2025-04-07 20:41:10,447 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:42:32,990 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:42:39,008 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:43:12,525 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:43:17,131 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')] | POST /auth/token/access
Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 324, in jsonable_encoder
    data = dict(obj)
TypeError: 'coroutine' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 329, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 296, in app
    content = await serialize_response(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 289, in jsonable_encoder
    encoded_value = jsonable_encoder(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'coroutine' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-04-07 20:43:25,400 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: 'AuthRepository' object has no attribute 'get_refresh_token' | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    |     saved_token = await self.authRepository.get_refresh_token(user_id)
    | AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    saved_token = await self.authRepository.get_refresh_token(user_id)
AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
2025-04-07 20:43:38,084 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: 'AuthRepository' object has no attribute 'get_refresh_token' | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    |     saved_token = await self.authRepository.get_refresh_token(user_id)
    | AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    saved_token = await self.authRepository.get_refresh_token(user_id)
AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
2025-04-07 20:52:56,405 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: 'AuthRepository' object has no attribute 'get_refresh_token' | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    |     saved_token = await self.authRepository.get_refresh_token(user_id)
    | AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 56, in rotate_token
    saved_token = await self.authRepository.get_refresh_token(user_id)
AttributeError: 'AuthRepository' object has no attribute 'get_refresh_token'. Did you mean: 'save_refresh_token'?
2025-04-07 20:53:03,620 [WARNING] [req_id:a7d114ee-1fe8-43fc-b851-533ca617a32f user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 20:53:03,622 [INFO] [req_id:a7d114ee-1fe8-43fc-b851-533ca617a32f user:1] base.py:35 - POST /auth/token/access [401] 0.0289s
2025-04-07 20:53:09,107 [DEBUG] [req_id:f813f6cd-b3f1-4a39-b8c2-8498cd13dea8 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 20:53:09,267 [INFO] [req_id:f813f6cd-b3f1-4a39-b8c2-8498cd13dea8 user:None] base.py:35 - POST /auth/login/email [200] 0.1754s
2025-04-07 20:53:16,995 [WARNING] [req_id:87840f9e-a55d-4cc8-9dfc-681bd0f035d0 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 20:53:16,996 [INFO] [req_id:87840f9e-a55d-4cc8-9dfc-681bd0f035d0 user:1] base.py:35 - POST /auth/token/access [401] 0.005s
2025-04-07 20:53:36,541 [INFO] [req_id:979bb2db-eb55-41ae-b1a4-52c5ac3e0b72 user:None] base.py:35 - POST /auth/login/email [200] 0.1339s
2025-04-07 21:12:58,711 [INFO] [req_id:88dc0eaf-9fef-4e99-b5af-db6f10d5c399 user:None] base.py:35 - POST /auth/login/email [200] 0.0991s
2025-04-07 21:13:37,558 [WARNING] [req_id:8d062a1a-04f4-4c1b-a9c0-26ad4b693e8a user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:13:37,559 [INFO] [req_id:8d062a1a-04f4-4c1b-a9c0-26ad4b693e8a user:1] base.py:35 - POST /auth/token/access [401] 0.005s
2025-04-07 21:13:43,074 [WARNING] [req_id:e6f12b5c-5490-4250-82a3-44f67ca33b43 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:13:43,075 [INFO] [req_id:e6f12b5c-5490-4250-82a3-44f67ca33b43 user:1] base.py:35 - POST /auth/token/access [401] 0.004s
2025-04-07 21:15:03,502 [INFO] [req_id:f4792b6e-4a03-4e5c-b9b9-e7f86e8fc46c user:None] base.py:35 - POST /auth/login/email [200] 0.1019s
2025-04-07 21:15:06,518 [INFO] [req_id:fdfccc37-74a6-4f69-a0ed-83def420f83c user:None] base.py:35 - POST /auth/login/email [200] 0.089s
2025-04-07 21:15:32,746 [INFO] [req_id:b21a111d-0bc5-41d8-9dee-e156d178702c user:None] base.py:35 - POST /auth/login/email [200] 17.5257s
2025-04-07 21:16:22,002 [INFO] [req_id:8b08a424-ced9-4e43-baad-9916a3d35c24 user:None] base.py:35 - POST /auth/login/email [200] 3.5916s
2025-04-07 21:16:29,067 [DEBUG] [req_id:0f61ebcf-2f42-40ad-a31b-1476620ea76a user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:16:29,249 [INFO] [req_id:0f61ebcf-2f42-40ad-a31b-1476620ea76a user:None] base.py:35 - POST /auth/login/email [200] 0.207s
2025-04-07 21:16:56,201 [WARNING] [req_id:859f652b-cb54-45cd-ad25-69d31fa364f1 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:16:56,202 [INFO] [req_id:859f652b-cb54-45cd-ad25-69d31fa364f1 user:1] base.py:35 - POST /auth/token/access [401] 0.0048s
2025-04-07 21:17:01,365 [WARNING] [req_id:969f284a-9cae-4d7d-98b5-93ef1c1855a2 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:17:01,366 [INFO] [req_id:969f284a-9cae-4d7d-98b5-93ef1c1855a2 user:1] base.py:35 - POST /auth/token/access [401] 0.0045s
2025-04-07 21:18:46,423 [WARNING] [req_id:ca689475-eb5b-47a9-a622-31fed0713efa user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:18:46,429 [INFO] [req_id:ca689475-eb5b-47a9-a622-31fed0713efa user:1] base.py:35 - POST /auth/token/access [401] 94.7119s
2025-04-07 21:22:18,407 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token' | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 63, in rotate_token
    |     return self.sign_token(user, is_refresh_token=is_refresh_token)
    | TypeError: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token'
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh_token=False)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 63, in rotate_token
    return self.sign_token(user, is_refresh_token=is_refresh_token)
TypeError: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token'
2025-04-07 21:24:41,979 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token' | POST /auth/token/access
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh=False)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 63, in rotate_token
    |     return self.sign_token(user, is_refresh=is_refresh)
    | TypeError: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token'
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 72, in new_access_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh=False)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\service.py", line 63, in rotate_token
    return self.sign_token(user, is_refresh=is_refresh)
TypeError: AuthService.sign_token() got an unexpected keyword argument 'is_refresh_token'
2025-04-07 21:24:47,931 [INFO] [req_id:b3446bf3-3a2e-466e-8890-7d3bb978734e user:1] base.py:35 - POST /auth/token/access [200] 0.0258s
2025-04-07 21:25:55,727 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: AuthService.rotate_token() got an unexpected keyword argument 'is_refresh_token' | POST /auth/token/refresh
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 87, in new_refresh_token
    |     new_token = await auth_service.rotate_token(raw_token, is_refresh=True)
    | TypeError: AuthService.rotate_token() got an unexpected keyword argument 'is_refresh_token'
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 87, in new_refresh_token
    new_token = await auth_service.rotate_token(raw_token, is_refresh=True)
TypeError: AuthService.rotate_token() got an unexpected keyword argument 'is_refresh_token'
2025-04-07 21:26:00,966 [INFO] [req_id:6b70ccf7-2d7b-4558-b1a8-cf5b6bdd1fc5 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0237s
2025-04-07 21:26:04,476 [INFO] [req_id:0492b93b-a626-456c-962a-89c05dc0d009 user:1] base.py:35 - POST /auth/token/access [200] 0.0038s
2025-04-07 21:26:06,883 [INFO] [req_id:b2c7c507-ff90-4ef1-b766-6c645d119a3d user:1] base.py:35 - POST /auth/token/refresh [200] 0.007s
2025-04-07 21:28:57,638 [INFO] [req_id:b246d47b-5d8c-4eea-9ac8-a4d6abc62dc1 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0057s
2025-04-07 21:29:11,014 [INFO] [req_id:2651be4c-87ab-45cc-8f4e-28191e04b2f0 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0252s
2025-04-07 21:35:47,937 [INFO] [req_id:87b27c0d-98a5-41a7-81af-837dda1badfe user:1] base.py:35 - POST /auth/token/refresh [200] 0.0061s
2025-04-07 21:35:54,440 [INFO] [req_id:a4886ef2-7b89-4e31-ba43-88d74b5aba08 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0283s
2025-04-07 21:36:04,474 [WARNING] [req_id:49ca70ef-fd7e-4e22-bf72-c35f9f7608d7 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/refresh
2025-04-07 21:36:04,475 [INFO] [req_id:49ca70ef-fd7e-4e22-bf72-c35f9f7608d7 user:1] base.py:35 - POST /auth/token/refresh [401] 0.005s
2025-04-07 21:36:18,460 [WARNING] [req_id:f38fd117-120c-419c-a397-f85311790706 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/refresh
2025-04-07 21:36:18,462 [INFO] [req_id:f38fd117-120c-419c-a397-f85311790706 user:1] base.py:35 - POST /auth/token/refresh [401] 0.005s
2025-04-07 21:36:21,491 [DEBUG] [req_id:27bd78d5-8a00-470f-9621-cc7d511ae3b4 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:36:21,649 [INFO] [req_id:27bd78d5-8a00-470f-9621-cc7d511ae3b4 user:None] base.py:35 - POST /auth/login/email [200] 0.1723s
2025-04-07 21:36:42,322 [INFO] [req_id:03740cec-5c18-4b31-a159-c1afe73f116d user:1] base.py:35 - POST /auth/token/access [200] 0.004s
2025-04-07 21:36:48,297 [INFO] [req_id:05b19bdd-4c56-4a09-96ce-1b9e4bfbadd2 user:1] base.py:35 - POST /auth/token/refresh [200] 0.0061s
2025-04-07 21:37:01,198 [WARNING] [req_id:d47b2297-5201-4dad-b2df-c2b6bc92c275 user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/access
2025-04-07 21:37:01,199 [INFO] [req_id:d47b2297-5201-4dad-b2df-c2b6bc92c275 user:1] base.py:35 - POST /auth/token/access [401] 0.005s
2025-04-07 21:37:15,022 [INFO] [req_id:708d0d6e-efe3-4ac5-880f-b8f7c96b71ce user:1] base.py:35 - POST /auth/token/access [200] 0.0051s
2025-04-07 21:38:55,122 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_part_begin with no data
2025-04-07 21:38:55,123 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_header_field with data[54:73]
2025-04-07 21:38:55,124 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_header_value with data[75:151]
2025-04-07 21:38:55,125 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 21:38:55,125 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_header_field with data[153:165]
2025-04-07 21:38:55,126 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_header_value with data[167:177]
2025-04-07 21:38:55,126 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 21:38:55,127 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_headers_finished with no data
2025-04-07 21:38:55,127 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_part_data with data[181:131253]
2025-04-07 21:38:55,131 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_part_data with data[0:262144]
2025-04-07 21:38:55,136 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:625 - Calling on_part_data with data[0:12905]
2025-04-07 21:38:55,137 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_part_end with no data
2025-04-07 21:38:55,138 [DEBUG] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] multipart.py:628 - Calling on_end with no data
2025-04-07 21:38:55,145 [INFO] [req_id:12e22774-15c5-45ac-8915-9812833404b6 user:1] base.py:35 - POST /common/image [200] 0.0286s
2025-04-07 21:39:01,209 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_part_begin with no data
2025-04-07 21:39:01,210 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_header_field with data[54:73]
2025-04-07 21:39:01,211 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_header_value with data[75:151]
2025-04-07 21:39:01,211 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 21:39:01,212 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_header_field with data[153:165]
2025-04-07 21:39:01,212 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_header_value with data[167:177]
2025-04-07 21:39:01,212 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_header_end with no data
2025-04-07 21:39:01,213 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_headers_finished with no data
2025-04-07 21:39:01,214 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_part_data with data[181:261392]
2025-04-07 21:39:01,218 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:625 - Calling on_part_data with data[0:144910]
2025-04-07 21:39:01,219 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_part_end with no data
2025-04-07 21:39:01,219 [DEBUG] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] multipart.py:628 - Calling on_end with no data
2025-04-07 21:39:01,232 [INFO] [req_id:b09a3d38-0833-4071-813f-22fa844a5959 user:1] base.py:35 - POST /common/image [200] 0.0272s
2025-04-07 21:39:13,977 [DEBUG] [req_id:f0472c40-aa78-4823-8e17-6318e0c88ffe user:1] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:39:14,075 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: A transaction is already begun on this Session. | POST /posts
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\post\route.py", line 50, in create_post
    |     async with session.begin():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\base.py", line 121, in __aenter__
    |     return await self.start(is_ctxmanager=True)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1891, in start
    |     await greenlet_spawn(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    |     result = context.switch(*args, **kwargs)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1943, in begin
    |     raise sa_exc.InvalidRequestError(
    | sqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\post\route.py", line 50, in create_post
    async with session.begin():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\base.py", line 121, in __aenter__
    return await self.start(is_ctxmanager=True)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1891, in start
    await greenlet_spawn(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\sqlalchemy\orm\session.py", line 1943, in begin
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: A transaction is already begun on this Session.
2025-04-07 21:40:46,747 [ERROR] [req_id:None user:1] handlers.py:89 - Unexpected server error: 'UserSchema' object is not subscriptable | POST /posts
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\post\route.py", line 55, in create_post
    |     post = await post_service.create_post(user.id, request)
    | TypeError: 'UserSchema' object is not subscriptable
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 59, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\post\route.py", line 55, in create_post
    post = await post_service.create_post(user.id, request)
TypeError: 'UserSchema' object is not subscriptable
2025-04-07 21:40:51,812 [DEBUG] [req_id:136301b3-4ced-4fcf-84fc-78baf5715b06 user:1] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:40:51,929 [INFO] [req_id:136301b3-4ced-4fcf-84fc-78baf5715b06 user:1] base.py:35 - POST /posts [200] 0.1851s
2025-04-07 21:44:21,976 [DEBUG] [req_id:39bc7c64-7cc4-483f-a182-d86ffede79ae user:1] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:44:22,037 [WARNING] [req_id:39bc7c64-7cc4-483f-a182-d86ffede79ae user:1] handlers.py:64 - Unhandled HTTPException: 400 - 존재하지 않는 이미지입니다. | POST /posts
2025-04-07 21:44:22,038 [INFO] [req_id:39bc7c64-7cc4-483f-a182-d86ffede79ae user:1] base.py:35 - POST /posts [400] 0.1425s
2025-04-07 21:44:27,182 [INFO] [req_id:2d61e510-eec2-4bde-bd8d-d45721da2cdc user:1] base.py:35 - GET /posts [200] 0.0311s
2025-04-07 21:44:32,460 [INFO] [req_id:9fb2e911-fed8-4291-80ff-ffd6c47860a2 user:1] base.py:35 - GET /posts/100 [200] 0.066s
2025-04-07 21:53:09,747 [DEBUG] [req_id:b5f74db8-3f8a-4932-8c65-74bb08036580 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:53:09,904 [ERROR] [req_id:None user:None] handlers.py:89 - Unexpected server error: name 'new_token' is not defined | POST /auth/login/email
  + Exception Group Traceback (most recent call last):
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\anyio\_backends\_asyncio.py", line 767, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    |     return await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    |     response = await call_next(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    |     response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    |     raise app_exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    |     await route.handle(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    |     response = await func(request)
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |   File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 30, in post_login_email
    |     set_refresh_token_cookie(response, tokens.refresh_token)
    | NameError: name 'new_token' is not defined
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 51, in auth_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 64, in redis_middleware
    return await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 42, in db_session_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 25, in log_context_middleware
    response = await call_next(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    with collapse_excgroups():
  File "c:\Users\jht56\anaconda3\envs\backend\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_utils.py", line 93, in collapse_excgroups
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\common\middleware\base.py", line 32, in request_logger_middleware
    response = await call_next(request) #  여기까지가 다른 미들웨어들 먼저 실행됨
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "c:\Users\jht56\anaconda3\envs\backend\lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\jht56\Documents\GitHub\fastapi-core\src\auth\route.py", line 30, in post_login_email
    set_refresh_token_cookie(response, tokens.refresh_token)
NameError: name 'new_token' is not defined
2025-04-07 21:53:14,937 [DEBUG] [req_id:4235d8a9-3cad-4370-8344-75485e181401 user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:53:15,081 [INFO] [req_id:4235d8a9-3cad-4370-8344-75485e181401 user:None] base.py:35 - POST /auth/login/email [200] 0.1763s
2025-04-07 21:53:16,936 [INFO] [req_id:28301db8-91e0-4363-a389-83cb7eebd776 user:None] base.py:35 - POST /auth/login/email [200] 0.0846s
2025-04-07 21:53:43,544 [INFO] [req_id:d93852ea-a82c-40d5-9533-238551c48bff user:1] base.py:35 - POST /auth/token/access [200] 0.005s
2025-04-07 21:53:49,869 [INFO] [req_id:4d1cebfa-7b91-47bd-8427-8bf586fc9add user:1] base.py:35 - POST /auth/token/refresh [200] 0.006s
2025-04-07 21:53:57,688 [INFO] [req_id:e0f8c9cc-e43c-4e20-a2d1-9fc9422d4ef6 user:1] base.py:35 - GET /posts [200] 0.0286s
2025-04-07 21:56:19,114 [INFO] [req_id:ec4f7bc7-2151-4406-91e9-0cf28f1298fc user:1] base.py:35 - POST /auth/token/refresh [200] 0.005s
2025-04-07 21:56:22,772 [WARNING] [req_id:8df40b64-c11b-45d8-aee6-7672a6144a4a user:1] handlers.py:64 - Unhandled HTTPException: 401 - 유효하지 않은 Refresh Token 입니다. | POST /auth/token/refresh
2025-04-07 21:56:22,774 [INFO] [req_id:8df40b64-c11b-45d8-aee6-7672a6144a4a user:1] base.py:35 - POST /auth/token/refresh [401] 0.0263s
2025-04-07 21:56:29,190 [DEBUG] [req_id:9579be7e-85fd-4172-bed2-c0b4ab91071d user:None] connection.py:951 - caching sha2: succeeded by fast path.
2025-04-07 21:56:29,357 [INFO] [req_id:9579be7e-85fd-4172-bed2-c0b4ab91071d user:None] base.py:35 - POST /auth/login/email [200] 0.1809s
2025-04-07 21:56:37,693 [INFO] [req_id:31e0737b-428e-4df9-a68f-83788caebdff user:1] base.py:35 - POST /auth/token/refresh [204] 0.0088s
2025-04-07 21:59:28,346 [INFO] [req_id:920adbc8-12ad-4478-86b8-694f4ff398b5 user:None] base.py:35 - POST /auth/login/email [200] 0.1409s
2025-04-07 21:59:34,566 [INFO] [req_id:c98f78a1-8857-45ce-8c50-b555fc8fbcdc user:1] base.py:35 - POST /auth/token/refresh [200] 0.0254s
